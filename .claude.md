# å°å°è¯»ä¹¦éƒ - Claude Code å¼€å‘æŒ‡å—

**é¡¹ç›®åç§°**: å°å°è¯»ä¹¦éƒ (TraditionalChineseStudy)  
**æŠ€æœ¯æ ˆ**: Node.js + Express + MySQL + Sequelize + EJS + Bootstrap  
**å¼€å‘å·¥å…·**: Claude Code + Docker Desktop  
**éƒ¨ç½²ç›®æ ‡**: GitHub + NameHero å…±äº«ä¸»æœº  
**æ›´æ–°æ—¶é—´**: 2025-07-20  

## ğŸ¯ é¡¹ç›®æ¦‚è¿°

ä¸€ä¸ªä¸“ä¸ºæµ·å¤–å„¿ç«¥è®¾è®¡çš„ä¸­åç»å…¸å­¦ä¹ å¹³å°ï¼Œæ”¯æŒã€Šé“å¾·ç»ã€‹ã€Šä¸‰å­—ç»ã€‹ã€Šå¼Ÿå­è§„ã€‹ç­‰ç»å…¸æ–‡æœ¬çš„é€å­—å­¦ä¹ ï¼Œé›†æˆç¬”é¡ºåŠ¨ç”»ã€æ‹¼éŸ³æ ‡æ³¨å’Œæ±‰å­—æ•…äº‹åŠŸèƒ½ã€‚

### æ ¸å¿ƒåŠŸèƒ½
- ğŸ“š ç»å…¸æ–‡æœ¬é˜…è¯»å™¨ (ç®€ç¹å¯¹ç…§ã€æ‹¼éŸ³æ ‡æ³¨)
- âœï¸ æ±‰å­—ç¬”é¡ºåŠ¨ç”» (hanzi-writer.js)
- ğŸ“– æ±‰å­—æ•…äº‹å’Œè¯æºè§£é‡Š
- ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ å®¶é•¿ç®¡ç†ç³»ç»Ÿ (å„¿ç«¥è´¦æˆ·ã€å­¦ä¹ è¿›åº¦)
- ğŸ¨ ä¸ªæ€§åŒ–å¤´åƒç³»ç»Ÿ
- ğŸ“Š å­¦ä¹ ç»Ÿè®¡å’Œè¿›åº¦è·Ÿè¸ª
- ğŸ” å®‰å…¨çš„ç®¡ç†åå°

## ğŸ—ï¸ æŠ€æœ¯æ¶æ„

### åç«¯æ¶æ„
```
Express.js åº”ç”¨
â”œâ”€â”€ è·¯ç”±å±‚ (routes/)
â”‚   â”œâ”€â”€ api.js          # RESTful API
â”‚   â”œâ”€â”€ web.js          # ç½‘é¡µè·¯ç”±
â”‚   â”œâ”€â”€ admin.js        # ç®¡ç†åå°
â”‚   â”œâ”€â”€ auth.js         # ç”¨æˆ·è®¤è¯
â”‚   â””â”€â”€ avatar.js       # å¤´åƒç®¡ç†
â”œâ”€â”€ æ•°æ®å±‚ (models/)
â”‚   â”œâ”€â”€ Classic.js      # ç»å…¸æ–‡æœ¬
â”‚   â”œâ”€â”€ Chapter.js      # ç« èŠ‚
â”‚   â”œâ”€â”€ Character.js    # æ±‰å­—
â”‚   â”œâ”€â”€ User.js         # ç”¨æˆ·
â”‚   â””â”€â”€ Child.js        # å„¿ç«¥ç”¨æˆ·
â”œâ”€â”€ ä¸­é—´ä»¶ (middleware/)
â”‚   â”œâ”€â”€ security.js     # å®‰å…¨ä¸­é—´ä»¶
â”‚   â””â”€â”€ errorHandler.js # é”™è¯¯å¤„ç†
â””â”€â”€ æœåŠ¡å±‚ (services/)
    â””â”€â”€ etymologyService.js # è¯æºæœåŠ¡
```

### æ•°æ®æ¨¡å‹å…³ç³»
```
User (å®¶é•¿) 1:N Child (å„¿ç«¥)
Classic 1:N Chapter 1:N Sentence
Character 1:N CharacterProgress
Child 1:N PracticeSession
Child 1:1 AvatarConfig
```

### å®‰å…¨ç‰¹æ€§
- Helmet.js å®‰å…¨å¤´è®¾ç½®
- CSRF ä»¤ç‰Œä¿æŠ¤
- è¾“å…¥éªŒè¯å’Œæ¸…ç† (express-validator)
- ä¼šè¯ç®¡ç† (express-session)
- é€Ÿç‡é™åˆ¶ (express-rate-limit)
- SQL æ³¨å…¥é˜²æŠ¤ (Sequelize å‚æ•°åŒ–æŸ¥è¯¢)

## ğŸŒ¿ Git å·¥ä½œæµç­–ç•¥

### åˆ†æ”¯ç­–ç•¥
```
main                    # ç”Ÿäº§åˆ†æ”¯ (ç¨³å®šç‰ˆæœ¬)
â”œâ”€â”€ develop            # å¼€å‘ä¸»åˆ†æ”¯ (é›†æˆåˆ†æ”¯)
â”œâ”€â”€ feature/åŠŸèƒ½åç§°    # åŠŸèƒ½å¼€å‘åˆ†æ”¯
â”œâ”€â”€ hotfix/ä¿®å¤åç§°     # ç´§æ€¥ä¿®å¤åˆ†æ”¯
â””â”€â”€ release/ç‰ˆæœ¬å·      # å‘å¸ƒå‡†å¤‡åˆ†æ”¯
```

### Claude Code å·¥ä½œæµç¨‹
1. **åŠŸèƒ½å¼€å‘**: ä» develop åˆ›å»º feature åˆ†æ”¯
2. **ä»£ç æäº¤**: éµå¾ªçº¦å®šå¼æäº¤è§„èŒƒ
3. **è‡ªåŠ¨æµ‹è¯•**: æ¯æ¬¡æäº¤è§¦å‘æµ‹è¯•
4. **ä»£ç å®¡æŸ¥**: åˆå¹¶å‰è¿›è¡Œå®¡æŸ¥
5. **é›†æˆæµ‹è¯•**: åˆå¹¶åˆ° develop åˆ†æ”¯
6. **å‘å¸ƒå‡†å¤‡**: åˆ›å»º release åˆ†æ”¯
7. **ç”Ÿäº§éƒ¨ç½²**: åˆå¹¶åˆ° main åˆ†æ”¯

### æäº¤ä¿¡æ¯è§„èŒƒ
```
feat: æ–°åŠŸèƒ½
fix: ä¿®å¤bug
docs: æ–‡æ¡£æ›´æ–°
style: ä»£ç æ ¼å¼
refactor: é‡æ„
test: æµ‹è¯•ç›¸å…³
chore: æ„å»º/å·¥å…·ç›¸å…³

ç¤ºä¾‹:
feat(reader): æ·»åŠ æ±‰å­—ç¬”é¡ºåŠ¨ç”»åŠŸèƒ½
fix(auth): ä¿®å¤ç™»å½•ä¼šè¯è¿‡æœŸé—®é¢˜
docs(api): æ›´æ–°APIæ–‡æ¡£
```

## ğŸš€ Claude Code å¼€å‘æœ€ä½³å®è·µ

### 1. é¡¹ç›®å¯åŠ¨æµç¨‹
```bash
# 1. å…‹éš†é¡¹ç›®
git clone https://github.com/kop0311/TraditionalChineseStudy.git
cd TraditionalChineseStudy

# 2. å®‰è£…ä¾èµ–
npm install

# 3. å¯åŠ¨Dockerç¯å¢ƒ
docker-compose up -d

# 4. åˆå§‹åŒ–æ•°æ®åº“
npm run migrate
npm run seed

# 5. å¯åŠ¨å¼€å‘æœåŠ¡å™¨
npm run dev
```

### 2. å¼€å‘ç¯å¢ƒé…ç½®
```bash
# å¼€å‘æ¨¡å¼ (çƒ­é‡è½½)
npm run dev

# æµ‹è¯•æ¨¡å¼
npm test
npm run test:watch

# ä»£ç æ£€æŸ¥
npm run lint
npm run lint:fix

# æ•°æ®åº“æ“ä½œ
npm run migrate      # è¿è¡Œè¿ç§»
npm run seed         # å¯¼å…¥ç§å­æ•°æ®
```

### 3. Docker å¼€å‘ç¯å¢ƒ
```yaml
# docker-compose.yml é…ç½®
services:
  mysql:
    image: mysql:8.0
    ports: ["3308:3306"]
    environment:
      MYSQL_DATABASE: xiaoxiao_dushulang
  
  app:
    build: .
    ports: ["9005:9005"]
    volumes:
      - .:/app
      - /app/node_modules
    command: npm run dev
```

## ğŸ“ ä»£ç è§„èŒƒ

### æ–‡ä»¶å‘½åè§„èŒƒ
- æ¨¡å‹æ–‡ä»¶: PascalCase (User.js, Character.js)
- è·¯ç”±æ–‡ä»¶: kebab-case (admin-enhanced.js)
- å·¥å…·æ–‡ä»¶: camelCase (errorHandler.js)
- è§†å›¾æ–‡ä»¶: kebab-case (character-edit.ejs)

### ä»£ç é£æ ¼
- ä½¿ç”¨ ESLint è¿›è¡Œä»£ç æ£€æŸ¥
- 2 ç©ºæ ¼ç¼©è¿›
- å•å¼•å·å­—ç¬¦ä¸²
- å°¾éšé€—å·
- åˆ†å·ç»“å°¾

### é”™è¯¯å¤„ç†
```javascript
// ç»Ÿä¸€é”™è¯¯å¤„ç†æ¨¡å¼
try {
  const result = await someAsyncOperation();
  res.json({ success: true, data: result });
} catch (error) {
  logger.error('Operation failed:', error);
  res.status(500).json({ 
    success: false, 
    message: 'æ“ä½œå¤±è´¥' 
  });
}
```

## ğŸ§ª æµ‹è¯•ç­–ç•¥

### æµ‹è¯•ç»“æ„
```
tests/
â”œâ”€â”€ unit/              # å•å…ƒæµ‹è¯•
â”‚   â”œâ”€â”€ security.test.js
â”‚   â””â”€â”€ errorHandler.test.js
â”œâ”€â”€ integration/       # é›†æˆæµ‹è¯•
â”‚   â”œâ”€â”€ api.test.js
â”‚   â””â”€â”€ auth.test.js
â””â”€â”€ e2e/              # ç«¯åˆ°ç«¯æµ‹è¯•
    â””â”€â”€ security.test.js
```

### æµ‹è¯•è¦†ç›–ç‡è¦æ±‚
- åˆ†æ”¯è¦†ç›–ç‡: â‰¥70%
- å‡½æ•°è¦†ç›–ç‡: â‰¥75%
- è¡Œè¦†ç›–ç‡: â‰¥80%
- è¯­å¥è¦†ç›–ç‡: â‰¥80%

### æµ‹è¯•å‘½ä»¤
```bash
npm test              # è¿è¡Œæ‰€æœ‰æµ‹è¯•
npm run test:watch    # ç›‘è§†æ¨¡å¼
npm run test:coverage # ç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Š
```

## ğŸ”§ å¼€å‘å·¥å…·é…ç½®

### VSCode æ¨èæ‰©å±•
- ESLint
- Prettier
- GitLens
- Thunder Client (APIæµ‹è¯•)
- MySQL (æ•°æ®åº“ç®¡ç†)

### ç¯å¢ƒå˜é‡é…ç½®
```bash
# .env.example
NODE_ENV=development
PORT=9001
DB_HOST=localhost
DB_PORT=3308
DB_USER=xxdsl_user
DB_PASS=xxdsl_password
DB_NAME=xiaoxiao_dushulang
SESSION_SECRET=xiaoxiao-dushulang-secret
ADMIN_PASS=123456
```

## ğŸ“¦ éƒ¨ç½²æµç¨‹

### æœ¬åœ°åˆ°GitHub
```bash
# 1. æäº¤ä»£ç 
git add .
git commit -m "feat: æ·»åŠ æ–°åŠŸèƒ½"
git push origin feature/åŠŸèƒ½åç§°

# 2. åˆ›å»ºPull Request
# 3. ä»£ç å®¡æŸ¥å’Œæµ‹è¯•
# 4. åˆå¹¶åˆ°developåˆ†æ”¯
```

### GitHubåˆ°ç”Ÿäº§ç¯å¢ƒ
```bash
# 1. åˆ›å»ºå‘å¸ƒåˆ†æ”¯
git checkout -b release/v2.1.0

# 2. ç‰ˆæœ¬å·æ›´æ–°
npm version patch

# 3. åˆå¹¶åˆ°mainåˆ†æ”¯
git checkout main
git merge release/v2.1.0

# 4. éƒ¨ç½²åˆ°NameHero
npm run deploy:shared
```

## ğŸš¨ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜
1. **æ•°æ®åº“è¿æ¥å¤±è´¥**
   ```bash
   docker-compose down
   docker-compose up -d mysql
   npm run migrate
   ```

2. **ç«¯å£å†²çª**
   ```bash
   # æ£€æŸ¥ç«¯å£å ç”¨
   netstat -ano | findstr :9005
   # ä¿®æ”¹docker-compose.ymlä¸­çš„ç«¯å£æ˜ å°„
   ```

3. **ä¾èµ–å®‰è£…å¤±è´¥**
   ```bash
   rm -rf node_modules package-lock.json
   npm cache clean --force
   npm install
   ```

## ğŸ“š å­¦ä¹ èµ„æº

### é¡¹ç›®ç›¸å…³
- [Express.js å®˜æ–¹æ–‡æ¡£](https://expressjs.com/)
- [Sequelize ORM æ–‡æ¡£](https://sequelize.org/)
- [EJS æ¨¡æ¿å¼•æ“](https://ejs.co/)
- [hanzi-writer.js](https://hanziwriter.org/)

### å¼€å‘å·¥å…·
- [Claude Code ä½¿ç”¨æŒ‡å—](https://claude.ai/code)
- [Docker å®˜æ–¹æ–‡æ¡£](https://docs.docker.com/)
- [Jest æµ‹è¯•æ¡†æ¶](https://jestjs.io/)

## ğŸ”„ è‡ªåŠ¨åŒ–å·¥ä½œæµ

### GitHub Actions (æ¨èé…ç½®)
```yaml
# .github/workflows/ci.yml
name: CI/CD Pipeline
on:
  push:
    branches: [main, develop]
  pull_request:
    branches: [main, develop]

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: actions/setup-node@v3
        with:
          node-version: '18'
      - run: npm ci
      - run: npm test
      - run: npm run lint
```

### æœ¬åœ°å¼€å‘è‡ªåŠ¨åŒ–è„šæœ¬
```bash
# scripts/dev-setup.sh
#!/bin/bash
echo "ğŸš€ å¯åŠ¨å¼€å‘ç¯å¢ƒ..."
docker-compose up -d mysql
npm run migrate
npm run seed
npm run dev
```

### Claude Code é›†æˆå‘½ä»¤
```bash
# å¿«é€Ÿå¼€å‘å‘½ä»¤
npm run claude:dev      # å¯åŠ¨å®Œæ•´å¼€å‘ç¯å¢ƒ
npm run claude:test     # è¿è¡Œæµ‹è¯•å¹¶ç”ŸæˆæŠ¥å‘Š
npm run claude:deploy   # éƒ¨ç½²åˆ°æµ‹è¯•ç¯å¢ƒ
npm run claude:clean    # æ¸…ç†å¼€å‘ç¯å¢ƒ
```

## ğŸ“Š æ€§èƒ½ç›‘æ§

### å…³é”®æŒ‡æ ‡
- å“åº”æ—¶é—´: < 200ms (API)
- é¡µé¢åŠ è½½: < 2s (é¦–å±)
- æ•°æ®åº“æŸ¥è¯¢: < 100ms
- å†…å­˜ä½¿ç”¨: < 512MB
- CPU ä½¿ç”¨: < 50%

### ç›‘æ§å·¥å…·
- Winston æ—¥å¿—ç³»ç»Ÿ
- æ€§èƒ½æŒ‡æ ‡æ”¶é›†
- é”™è¯¯è¿½è¸ª
- ç”¨æˆ·è¡Œä¸ºåˆ†æ

## ğŸ” å®‰å…¨æ£€æŸ¥æ¸…å•

### ä»£ç å®‰å…¨
- [ ] è¾“å…¥éªŒè¯å’Œæ¸…ç†
- [ ] SQL æ³¨å…¥é˜²æŠ¤
- [ ] XSS é˜²æŠ¤
- [ ] CSRF ä»¤ç‰ŒéªŒè¯
- [ ] å®‰å…¨å¤´è®¾ç½®
- [ ] ä¼šè¯ç®¡ç†
- [ ] å¯†ç åŠ å¯†å­˜å‚¨

### éƒ¨ç½²å®‰å…¨
- [ ] HTTPS å¼ºåˆ¶
- [ ] ç¯å¢ƒå˜é‡ä¿æŠ¤
- [ ] æ•°æ®åº“è®¿é—®æ§åˆ¶
- [ ] æ–‡ä»¶æƒé™è®¾ç½®
- [ ] æ—¥å¿—å®‰å…¨é…ç½®

## ğŸ¨ UI/UX è®¾è®¡è§„èŒƒ

### è®¾è®¡åŸåˆ™
- ç®€æ´ç›´è§‚çš„ç•Œé¢
- é€‚åˆå„¿ç«¥çš„è‰²å½©æ­é…
- å“åº”å¼è®¾è®¡
- æ— éšœç¢è®¿é—®æ”¯æŒ
- å¿«é€ŸåŠ è½½ä¼˜åŒ–

### ç»„ä»¶åº“
- Bootstrap 5 åŸºç¡€ç»„ä»¶
- è‡ªå®šä¹‰æ±‰å­—æ˜¾ç¤ºç»„ä»¶
- ç¬”é¡ºåŠ¨ç”»ç»„ä»¶
- è¿›åº¦è·Ÿè¸ªç»„ä»¶

## ğŸ“± ç§»åŠ¨ç«¯ä¼˜åŒ–

### å“åº”å¼æ–­ç‚¹
```css
/* æ‰‹æœº */
@media (max-width: 576px) { }

/* å¹³æ¿ */
@media (min-width: 768px) { }

/* æ¡Œé¢ */
@media (min-width: 992px) { }
```

### è§¦æ‘¸ä¼˜åŒ–
- æŒ‰é’®æœ€å°å°ºå¯¸ 44px
- æ‰‹åŠ¿æ”¯æŒ
- è§¦æ‘¸åé¦ˆ
- æ»‘åŠ¨å¯¼èˆª

## ğŸŒ å›½é™…åŒ–æ”¯æŒ

### å¤šè¯­è¨€é…ç½®
```javascript
// æ”¯æŒè¯­è¨€
const languages = {
  'zh-CN': 'ç®€ä½“ä¸­æ–‡',
  'zh-TW': 'ç¹é«”ä¸­æ–‡',
  'en-US': 'English'
};
```

### æ–‡æœ¬èµ„æºç®¡ç†
- ç»Ÿä¸€çš„ç¿»è¯‘æ–‡ä»¶
- åŠ¨æ€è¯­è¨€åˆ‡æ¢
- å­—ä½“é€‚é…
- æ–‡åŒ–é€‚åº”æ€§

## ğŸ”§ å¼€å‘å·¥å…·æ‰©å±•

### Claude Code ä¸“ç”¨é…ç½®
```json
{
  "claude.autoSave": true,
  "claude.linting": true,
  "claude.testing": "auto",
  "claude.deployment": "staging-first"
}
```

### æ¨è VS Code è®¾ç½®
```json
{
  "editor.formatOnSave": true,
  "editor.codeActionsOnSave": {
    "source.fixAll.eslint": true
  },
  "emmet.includeLanguages": {
    "ejs": "html"
  }
}
```

## ğŸ“ˆ é¡¹ç›®è·¯çº¿å›¾

### å½“å‰ç‰ˆæœ¬ (v2.0)
- âœ… åŸºç¡€é˜…è¯»åŠŸèƒ½
- âœ… æ±‰å­—ç¬”é¡ºåŠ¨ç”»
- âœ… ç”¨æˆ·ç®¡ç†ç³»ç»Ÿ
- âœ… ç®¡ç†åå°

### ä¸‹ä¸€ç‰ˆæœ¬ (v2.1)
- ğŸ”„ è¯­éŸ³æœ—è¯»åŠŸèƒ½
- ğŸ”„ å­¦ä¹ æ¸¸æˆæ¨¡å—
- ğŸ”„ ç¤¾äº¤åˆ†äº«åŠŸèƒ½
- ğŸ”„ ç¦»çº¿æ¨¡å¼æ”¯æŒ

### æœªæ¥è§„åˆ’ (v3.0)
- ğŸ“‹ AI æ™ºèƒ½æ¨è
- ğŸ“‹ è™šæ‹Ÿè€å¸ˆåŠ©æ‰‹
- ğŸ“‹ AR/VR ä½“éªŒ
- ğŸ“‹ å¤šå¹³å°åº”ç”¨

---

**æ³¨æ„**: æœ¬æ–‡æ¡£ä¼šéšç€é¡¹ç›®å‘å±•æŒç»­æ›´æ–°ï¼Œè¯·å®šæœŸæŸ¥çœ‹æœ€æ–°ç‰ˆæœ¬ã€‚

**æœ€åæ›´æ–°**: 2025-07-20
**æ–‡æ¡£ç‰ˆæœ¬**: v1.0
**ç»´æŠ¤è€…**: Claude Code Team
